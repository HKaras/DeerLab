

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dipolarkernel &mdash; DeerLab  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="/source/_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="/source/_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/table_util.css" type="text/css" />
  <link rel="stylesheet" href="../_static/table_main.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dipolarbackground" href="dipolarbackground.html" />
    <link rel="prev" title="Functions" href="../functions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v0.11.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation instructions</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firstscript.html">A first script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preprocess.html">Loading and preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitting.html">Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uncertainty.html">Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modelsref.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
</ul>
<p class="caption"><span class="caption-text">Others</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../funding.html">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DeerLab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../functions.html">Functions</a> &raquo;</li>
        
      <li><code class="xref py py-mod docutils literal notranslate"><span class="pre">dipolarkernel</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dipolarkernel">
<span id="id1"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">dipolarkernel</span></code><a class="headerlink" href="#dipolarkernel" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="deerlab.dipolarkernel">
<code class="sig-prename descclassname">deerlab.</code><code class="sig-name descname">dipolarkernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em>, <em class="sig-param"><span class="n">r</span></em>, <em class="sig-param"><span class="n">pathinfo</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">B</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'fresnel'</span></em>, <em class="sig-param"><span class="n">excbandwidth</span><span class="o">=</span><span class="default_value">inf</span></em>, <em class="sig-param"><span class="n">g</span><span class="o">=</span><span class="default_value">[2.00231930436256, 2.00231930436256]</span></em>, <em class="sig-param"><span class="n">integralop</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">nKnots</span><span class="o">=</span><span class="default_value">5001</span></em>, <em class="sig-param"><span class="n">renormalize</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">clearcache</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deerlab/dipolarkernel.html#dipolarkernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deerlab.dipolarkernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the dipolar kernel operator which enables the linear transformation from
distance-domain to time-domain data.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t</strong><span class="classifier">array_like</span></dt><dd><p>Dipolar time axis, in microseconds.</p>
</dd>
<dt><strong>r</strong><span class="classifier">array_like</span></dt><dd><p>Distance axis, in nanometers.</p>
</dd>
<dt><strong>pathinfo</strong><span class="classifier">array_like with shape (p,2) or (p,3)</span></dt><dd><p>Array of pathway amplitudes (lambda), refocusing points (T0), and harmonics (n) 
for multiple (p) dipolar pathways. Each row contains <code class="docutils literal notranslate"><span class="pre">[lambda</span> <span class="pre">T0</span> <span class="pre">n]</span></code> or <code class="docutils literal notranslate"><span class="pre">[lambda</span> <span class="pre">T0]</span></code> 
for one pathway. If n is not given it is assumed to be 1. For a pathway with unmodulated contribution, set the refocusing time to <code class="docutils literal notranslate"><span class="pre">numpy.nan</span></code>.</p>
</dd>
<dt><strong>B</strong><span class="classifier">callable or array_like</span></dt><dd><p>For a single-pathway model, the numerical background decay can be passed as an array. 
For multiple pathways, a callable function must be passed, accepting a time-axis array as first input and a pathway amplitude as a second, i.e. <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">=</span> <span class="pre">lambda</span> <span class="pre">t,lam:</span> <span class="pre">bg_model(t,par,lam)</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>K</strong><span class="classifier">ndarray</span></dt><dd><p>Dipolar kernel operator, such that for a distance distribution (P), the dipolar signal is <code class="docutils literal notranslate"><span class="pre">V</span> <span class="pre">=</span> <span class="pre">K&#64;P</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>method</strong><span class="classifier">string, default=``’fresnel’``</span></dt><dd><p>Numerical method for kernel matrix calculation:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘fresnel’ - uses Fresnel integrals for the kernel (default)</p></li>
<li><p>‘integral’ - uses explicit integration function (slow, accurate)</p></li>
<li><p>‘grid’ - powder average via explicit grid integration (slow, inaccurate)</p></li>
</ul>
</div></blockquote>
</dd>
<dt><strong>excbandwidth</strong><span class="classifier">scalar, optional</span></dt><dd><p>Excitation bandwidth of the pulses in MHz to account for limited excitation bandwidth <a class="reference internal" href="#r23328abbf0e7-4" id="id2">[4]</a>.</p>
</dd>
<dt><strong>g</strong><span class="classifier">scalar, 2-element array, optional</span></dt><dd><p>Electron g-values of the spin centers <code class="docutils literal notranslate"><span class="pre">[g1,</span> <span class="pre">g2]</span></code>. If a single g is specified, [g, g] is assumed</p>
</dd>
<dt><strong>integralop</strong><span class="classifier">boolean, optional</span></dt><dd><p>Whether to return K as an integral operator (i.e <code class="docutils literal notranslate"><span class="pre">K</span> <span class="pre">=</span> <span class="pre">K*dr</span></code>) or not (<code class="docutils literal notranslate"><span class="pre">K</span></code>). Usage as an integral operator means that the matrix operation <code class="docutils literal notranslate"><span class="pre">V=K&#64;P</span></code> with a normalized distance distribution (i.e. <code class="docutils literal notranslate"><span class="pre">trapz(r,P)==1</span></code>) leads to a signal <code class="docutils literal notranslate"><span class="pre">V</span></code> with ampliude <code class="docutils literal notranslate"><span class="pre">V(t=0)=1</span></code>. Default is True.</p>
</dd>
<dt><strong>nKnots</strong><span class="classifier">scalar, optional</span></dt><dd><p>Number of knots for the grid of powder orientations to be used in the ‘grid’ kernel calculation method.</p>
</dd>
<dt><strong>renormalize</strong><span class="classifier">boolean, optional</span></dt><dd><p>Re-normalization of multi-pathway kernels to ensure the equality <code class="docutils literal notranslate"><span class="pre">K(t=0,r)==1</span></code> is satisfied. Default is True.</p>
</dd>
<dt><strong>clearcache</strong><span class="classifier">boolean, optional</span></dt><dd><p>Clear the cached dipolar kernels at the beginning of the function. Default is False.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a multi-pathway DEER <a class="reference internal" href="#r23328abbf0e7-1" id="id3">[1]</a> signal (e.g, 4-pulse DEER with 2+1 contribution 5-pulse DEER with 4-pulse DEER residual signal, and more complicated experiments), <code class="docutils literal notranslate"><span class="pre">pathinfo</span></code> contains a list of modulation depths (amplitudes) and refocusing times (in microseconds).
The background function specified as ‘’B’’ is used as basis function, and the actual multipathway background included into the kernel is compued using <a class="reference internal" href="dipolarbackground.html#dipolarbackground"><span class="std std-ref">dipolarbackground</span></a>. The background in included in the dipolar kernel definition <a class="reference internal" href="#r23328abbf0e7-2" id="id4">[2]</a>. 
Optionally, the harmonic (1 = fundamental, 2 = first overtone, etc.) can be given as a third value in each row. This can be useful for modeling RIDME signals <a class="reference internal" href="#r23328abbf0e7-3" id="id5">[3]</a>. If not given, the harmonic is 1 for all pathways.</p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r23328abbf0e7-1"><span class="brackets"><a class="fn-backref" href="#id3">1</a></span></dt>
<dd><ol class="upperalpha simple" start="12">
<li><p>Fábregas Ibáñez, G. Jeschke, and S. Stoll: “DeerLab: A comprehensive toolbox for analyzing dipolar EPR spectroscopy data”, Magn. Reson. Discuss., 2020</p></li>
</ol>
</dd>
<dt class="label" id="r23328abbf0e7-2"><span class="brackets"><a class="fn-backref" href="#id4">2</a></span></dt>
<dd><p>Fábregas Ibáñez, L. and Jeschke, G.: Optimal background treatment in dipolar spectroscopy, Physical Chemistry Chemical Physics, 22, 1855–1868, 2020.</p>
</dd>
<dt class="label" id="r23328abbf0e7-3"><span class="brackets"><a class="fn-backref" href="#id5">3</a></span></dt>
<dd><p>Keller, K., Mertens, V., Qi, M., Nalepa, A. I., Godt, A., Savitsky, A., Jeschke, G., and Yulikov, M.: Computing distance distributions from dipolar evolution data with overtones: RIDME spectroscopy with Gd(III)-based spin labels, Physical Chemistry Chemical Physics, 19</p>
</dd>
<dt class="label" id="r23328abbf0e7-4"><span class="brackets"><a class="fn-backref" href="#id2">4</a></span></dt>
<dd><p>J.E. Banham, C.M. Baker, S. Ceola, I.J. Day, G.H. Grant, E.J.J. Groenen, C.T. Rodgers, G. Jeschke, C.R. Timmel, Distance measurements in the borderline region of applicability of CW EPR and DEER: A model study on a homologous series of spin-labelled peptides, Journal of Magnetic Resonance, 191, 2, 2008, 202-218</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To specify the standard model for 4-pulse DEER with an unmodulated offset and a single dipolar pathway that refocuses at time 0, use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lam</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># modulation depth main signal</span>
<span class="n">pathinfo</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="o">-</span><span class="n">lam</span><span class="p">,</span> <span class="n">nan</span><span class="p">],</span> <span class="p">[</span><span class="n">lam</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

<span class="n">K</span> <span class="o">=</span> <span class="nf">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathinfo</span><span class="p">)</span>
</pre></div>
</div>
<p>A shorthand input syntax equivalent to this input:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lam</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">K</span> <span class="o">=</span> <span class="nf">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">lam</span><span class="p">)</span>

<span class="n">To</span> <span class="n">specify</span> <span class="n">a</span> <span class="n">more</span> <span class="n">complete</span> <span class="mi">4</span><span class="o">-</span><span class="n">pulse</span> <span class="n">DEER</span> <span class="n">model</span> <span class="n">that</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span> <span class="n">includes</span> <span class="n">the</span> <span class="mi">2</span><span class="o">+</span><span class="mi">1</span> <span class="n">contribution</span><span class="p">,</span> <span class="n">use</span><span class="p">::</span>

<span class="n">Lam0</span> <span class="o">=</span> <span class="mf">0.5</span>                     <span class="c1"># unmodulated part</span>
<span class="n">lam</span> <span class="o">=</span> <span class="mf">0.4</span>                      <span class="c1"># modulation depth main signal</span>
<span class="n">lam21</span> <span class="o">=</span> <span class="mf">0.1</span>                    <span class="c1"># modulation depth 2+1 contribution</span>
<span class="n">tau2</span> <span class="o">=</span> <span class="mi">4</span>                       <span class="c1"># refocusing time of 2+1 contribution</span>
<span class="n">pathinfo</span> <span class="o">=</span> <span class="p">[[],[],[]]</span>
<span class="n">pathinfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Lam0</span><span class="p">,</span>   <span class="n">nan</span><span class="p">]</span>    <span class="c1"># unmodulated part, gives offset</span>
<span class="n">pathinfo</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lama</span><span class="p">,</span>    <span class="mi">0</span> <span class="p">]</span>    <span class="c1"># main modulation, refocusing at time zero</span>
<span class="n">pathinfo</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">lam21</span><span class="p">,</span> <span class="n">tau2</span><span class="p">]</span>    <span class="c1"># 2+1 modulation, refocusing at time tau2</span>

<span class="n">K</span> <span class="o">=</span> <span class="nf">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathinfo</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dipolarbackground.html" class="btn btn-neutral float-right" title="dipolarbackground" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../functions.html" class="btn btn-neutral float-left" title="Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019-2020, Luis Fábregas Ibáñez, Stefan Stoll, and others

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>