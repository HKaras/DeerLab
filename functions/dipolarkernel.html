

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>dipolarkernel &mdash; DeerLab</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/plot_directive.css" type="text/css" />
  <link rel="stylesheet" href="/source/_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="/source/_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/table_util.css" type="text/css" />
  <link rel="stylesheet" href="../_static/table_main.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-rendered-html.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="dipolarbackground" href="dipolarbackground.html" />
    <link rel="prev" title="Functions" href="../functions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                v0.13.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginners_guide.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uncertainty.html">Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modelsref.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
</ul>
<p class="caption"><span class="caption-text">Others</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../funding.html">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DeerLab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../functions.html">Functions</a> &raquo;</li>
        
      <li><code class="docutils literal notranslate"><span class="pre">dipolarkernel</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="dipolarkernel">
<span id="id1"></span><h1><code class="xref py py-mod docutils literal notranslate"><span class="pre">dipolarkernel</span></code><a class="headerlink" href="#dipolarkernel" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="deerlab.dipolarkernel">
<code class="descclassname">deerlab.</code><code class="descname">dipolarkernel</code><span class="sig-paren">(</span><em>t, r, *, pathways=None, mod=None, bg=None, method='fresnel', excbandwidth=inf, g=[2.00231930436256, 2.00231930436256], integralop=True, nKnots=5001, clearcache=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/deerlab/dipolarkernel.html#dipolarkernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deerlab.dipolarkernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the dipolar kernel operator which enables the linear transformation from
distance-domain to time-domain data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>t</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Dipolar time axis, in microseconds.</p>
</dd>
<dt><strong>r</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Distance axis, in nanometers.</p>
</dd>
<dt><strong>pathways</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list of lists  or <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional</span></dt>
<dd><p class="first last">List of pathways. Each pathway is defined as a list of the pathway’s amplitude (lambda), refocusing time in microseconds (T0), 
and harmonic (n), i.e. <code class="docutils literal notranslate"><span class="pre">[lambda,</span> <span class="pre">T0,</span> <span class="pre">n]</span></code> or <code class="docutils literal notranslate"><span class="pre">[lambda,</span> <span class="pre">T0]</span></code>. If n is not given, it is assumed to be 1. 
For a unmodulated pathway, specify only the amplitude, i.e. <code class="docutils literal notranslate"><span class="pre">[Lambda0]</span></code>. If neither <code class="docutils literal notranslate"><span class="pre">pathways</span></code> or <code class="docutils literal notranslate"><span class="pre">mod</span></code> are specified
(or <code class="docutils literal notranslate"><span class="pre">None</span></code>), full-modulation is assumed <code class="docutils literal notranslate"><span class="pre">pathways=[[1,0]]</span></code>.</p>
</dd>
<dt><strong>mod</strong> <span class="classifier-delimiter">:</span> <span class="classifier">scalar  or <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional</span></dt>
<dd><p class="first last">Modulation depth for the simplified 4-pulse DEER model. If neither <code class="docutils literal notranslate"><span class="pre">pathways</span></code> or <code class="docutils literal notranslate"><span class="pre">mod</span></code> are specified (or <code class="docutils literal notranslate"><span class="pre">None</span></code>),
it is assumed to be <a href="#id2"><span class="problematic" id="id3">``</span></a>mod=1`.</p>
</dd>
<dt><strong>bg</strong> <span class="classifier-delimiter">:</span> <span class="classifier">callable or array_like or <code class="docutils literal notranslate"><span class="pre">None</span></code>, optional</span></dt>
<dd><p class="first last">For a single-pathway model, the numerical background decay can be passed as an array. 
For multiple pathways, a callable function must be passed, accepting a time-axis array as first input and a pathway amplitude as a second, i.e. <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">=</span> <span class="pre">lambda</span> <span class="pre">t,lam:</span> <span class="pre">bg_model(t,par,lam)</span></code>. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, no background decay is included.</p>
</dd>
<dt><strong>method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string, optional</span></dt>
<dd><p class="first">Numerical method for kernel matrix calculation:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">'fresnel'</span></code> - uses Fresnel integrals for the kernel (default)</li>
<li><code class="docutils literal notranslate"><span class="pre">'integral'</span></code> - uses explicit integration function (slow, accurate)</li>
<li><code class="docutils literal notranslate"><span class="pre">'grid'</span></code> - powder average via explicit grid integration (slow, inaccurate)</li>
</ul>
</div></blockquote>
<p class="last">The default is <code class="docutils literal notranslate"><span class="pre">'fresnel'</span></code>.</p>
</dd>
<dt><strong>excbandwidth</strong> <span class="classifier-delimiter">:</span> <span class="classifier">scalar, optional</span></dt>
<dd><p class="first last">Excitation bandwidth of the pulses in MHz to account for limited excitation bandwidth <a class="reference internal" href="#r23328abbf0e7-4" id="id4">[4]</a>.</p>
</dd>
<dt><strong>g</strong> <span class="classifier-delimiter">:</span> <span class="classifier">scalar, 2-element array, optional</span></dt>
<dd><p class="first last">Electron g-values of the spin centers <code class="docutils literal notranslate"><span class="pre">[g1,</span> <span class="pre">g2]</span></code>. If a single g is specified, <code class="docutils literal notranslate"><span class="pre">[g,</span> <span class="pre">g]</span></code> is assumed</p>
</dd>
<dt><strong>integralop</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean, optional</span></dt>
<dd><p class="first last">Whether to return K as an integral operator (i.e <code class="docutils literal notranslate"><span class="pre">K</span> <span class="pre">=</span> <span class="pre">K*dr</span></code>) or not (<code class="docutils literal notranslate"><span class="pre">K</span></code>). Usage as an integral operator means that the 
matrix operation <code class="docutils literal notranslate"><span class="pre">V=K&#64;P</span></code> with a normalized distance distribution (i.e. <code class="docutils literal notranslate"><span class="pre">trapz(r,P)==1</span></code>) leads to a signal <code class="docutils literal notranslate"><span class="pre">V</span></code> with 
ampliude <code class="docutils literal notranslate"><span class="pre">V(t=0)=1</span></code>. Enabled by default.</p>
</dd>
<dt><strong>nKnots</strong> <span class="classifier-delimiter">:</span> <span class="classifier">scalar, optional</span></dt>
<dd><p class="first last">Number of knots for the grid of powder orientations to be used in the <code class="docutils literal notranslate"><span class="pre">'grid'</span></code> kernel calculation method.</p>
</dd>
<dt><strong>clearcache</strong> <span class="classifier-delimiter">:</span> <span class="classifier">boolean, optional</span></dt>
<dd><p class="first last">Clear the cached dipolar kernels at the beginning of the function. Disabled by default.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>K</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Dipolar kernel operator, such that for a distance distribution (P), the dipolar signal is <code class="docutils literal notranslate"><span class="pre">V</span> <span class="pre">=</span> <span class="pre">K&#64;P</span></code></p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For a multi-pathway DEER <a class="reference internal" href="#r23328abbf0e7-1" id="id5">[1]</a> signal (e.g, 4-pulse DEER with 2+1 contribution 5-pulse DEER with 4-pulse DEER residual signal, and more complicated experiments), <code class="docutils literal notranslate"><span class="pre">pathways</span></code> contains a list of modulation depths (amplitudes) and refocusing times (in microseconds).
The background function specified as ‘’B’’ is used as basis function, and the actual multipathway background included into the kernel is compued using <a class="reference internal" href="dipolarbackground.html#dipolarbackground"><span class="std std-ref">dipolarbackground</span></a>. The background in included in the dipolar kernel definition <a class="reference internal" href="#r23328abbf0e7-2" id="id6">[2]</a>. 
Optionally, the harmonic (1 = fundamental, 2 = first overtone, etc.) can be given as a third value in each row. This can be useful for modeling RIDME signals <a class="reference internal" href="#r23328abbf0e7-3" id="id7">[3]</a>. If not given, the harmonic is 1 for all pathways.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="r23328abbf0e7-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[1]</a></td><td>L. Fábregas Ibáñez, G. Jeschke, and S. Stoll. 
DeerLab: A comprehensive toolbox for analyzing dipolar EPR spectroscopy data, Magn. Reson., 1, 209–224, 2020</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r23328abbf0e7-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[2]</a></td><td>L. Fábregas Ibáñez, and G. Jeschke
Optimal background treatment in dipolar spectroscopy, Physical Chemistry Chemical Physics, 22, 1855–1868, 2020.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r23328abbf0e7-3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[3]</a></td><td>K. Keller, V. Mertens, M. Qi, A. I. Nalepa, A. Godt, A. Savitsky, G. Jeschke, and M. Yulikov
Computing distance distributions from dipolar evolution data with overtones: RIDME spectroscopy with Gd(III)-based spin labels, Physical Chemistry Chemical Physics, 19</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="r23328abbf0e7-4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td>J. E. Banham, C. M. Baker, S. Ceola, I. J. Day, G.H. Grant, E. J. J. Groenen, C. T. Rodgers, G. Jeschke, C. R. Timmel
Distance measurements in the borderline region of applicability of CW EPR and DEER: A model study on a homologous series of spin-labelled peptides, Journal of Magnetic Resonance, 191, 2, 2008, 202-218</td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>To specify the standard model for 4-pulse DEER with an unmodulated offset and a single dipolar pathway that refocuses at time 0, use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lam</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># modulation depth main signal</span>
<span class="n">pathways</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="o">-</span><span class="n">lam</span><span class="p">],</span> <span class="p">[</span><span class="n">lam</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

<span class="n">K</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="nf">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathways</span><span class="o">=</span><span class="n">pathways</span><span class="p">)</span>
</pre></div>
</div>
<p>A shorthand input syntax equivalent to this input:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">lam</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="nf">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">mod</span><span class="o">=</span><span class="n">lam</span><span class="p">)</span>

<span class="n">To</span> <span class="n">specify</span> <span class="n">a</span> <span class="n">more</span> <span class="n">complete</span> <span class="mi">4</span><span class="o">-</span><span class="n">pulse</span> <span class="n">DEER</span> <span class="n">model</span> <span class="n">that</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span> <span class="n">includes</span> <span class="n">the</span> <span class="mi">2</span><span class="o">+</span><span class="mi">1</span> <span class="n">contribution</span><span class="p">,</span> <span class="n">use</span><span class="p">::</span>

<span class="n">Lam0</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># unmodulated part</span>
<span class="n">lam</span> <span class="o">=</span> <span class="mf">0.4</span>  <span class="c1"># modulation depth main signal</span>
<span class="n">lam21</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># modulation depth 2+1 contribution</span>
<span class="n">tau2</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># refocusing time (µs) of 2+1 contribution</span>

<span class="n">path0</span> <span class="o">=</span> <span class="n">Lam0</span>  <span class="c1"># unmodulated pathway</span>
<span class="n">path1</span> <span class="o">=</span> <span class="p">[</span><span class="n">lam1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># main dipolar pathway, refocusing at time zero</span>
<span class="n">path1</span> <span class="o">=</span> <span class="p">[</span><span class="n">lam2</span><span class="p">,</span> <span class="n">tau2</span><span class="p">]</span>  <span class="c1"># 2+1 dipolar pathway, refocusing at time tau2</span>
<span class="n">pathways</span> <span class="o">=</span> <span class="p">[</span><span class="n">path0</span><span class="p">,</span> <span class="n">path1</span><span class="p">,</span> <span class="n">path2</span><span class="p">]</span>  

<span class="n">K</span> <span class="o">=</span> <span class="n">dl</span><span class="o">.</span><span class="nf">dipolarkernel</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">pathways</span><span class="o">=</span><span class="n">pathways</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dipolarbackground.html" class="btn btn-neutral float-right" title="dipolarbackground" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../functions.html" class="btn btn-neutral float-left" title="Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019-2021, Luis Fábregas Ibáñez, Stefan Stoll, and others.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>