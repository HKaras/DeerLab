

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Global model fits with global, local and fixed parameters &mdash; DeerLab  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="/source/_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="/source/_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/table_util.css" type="text/css" />
  <link rel="stylesheet" href="../_static/table_main.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bootstrapped distributions of fit parameters" href="plot_bootstrapped_parameter_distributions.html" />
    <link rel="prev" title="Multi-Gauss fit of a 4-pulse DEER signal" href="plot_multigauss_fitting_4pdeer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation instructions</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../firstscript.html">A first script</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basics.html">Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../preprocess.html">Loading and preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fitting.html">Fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uncertainty.html">Uncertainty</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modelsref.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
</ul>
<p class="caption"><span class="caption-text">Others</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../funding.html">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">DeerLab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../examples.html">Examples</a> &raquo;</li>
        
      <li>Global model fits with global, local and fixed parameters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-plot-globalfits-local-and-global-parameters-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="global-model-fits-with-global-local-and-fixed-parameters">
<span id="sphx-glr-auto-examples-plot-globalfits-local-and-global-parameters-py"></span><h1>Global model fits with global, local and fixed parameters<a class="headerlink" href="#global-model-fits-with-global-local-and-fixed-parameters" title="Permalink to this headline">¶</a></h1>
<p>This example shows how to fit multiple signals to a global model, which
may depend on some parameters which need to be globally fitted, some
locally and some might be fixed and not fitted.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">deerlab</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="section" id="generate-two-datasets">
<h2>Generate two datasets<a class="headerlink" href="#generate-two-datasets" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>For this example we will simulate a system containing two states A and B
both havng a Gaussian distribution of known width but unknown mean
distance. For this system we have two measurements V1 amd V2 measured
under two different conditions leading to different fractions of states A
and B.</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">300</span><span class="p">)</span>  <span class="c1"># distance axis, in nm</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span> <span class="c1"># time axis of first measurement, in us</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">150</span><span class="p">)</span> <span class="c1"># time axis of first measurement, in us</span>

<span class="c1"># Parameters</span>
<span class="n">rmeanA</span> <span class="o">=</span> <span class="mf">3.45</span> <span class="c1"># mean distance state A, in nm</span>
<span class="n">rmeanB</span> <span class="o">=</span> <span class="mf">5.05</span> <span class="c1"># mean distance state B, in nm</span>
<span class="n">fwhmA</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="c1"># FWHM state A, in nm</span>
<span class="n">fwhmB</span> <span class="o">=</span> <span class="mf">0.3</span> <span class="c1"># FWHM state B, in nm</span>

<span class="n">fracA1</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="c1"># Molar fraction of state A under conditions 1</span>
<span class="n">fracA2</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># Molar fraction of state A under conditions 2</span>
<span class="c1"># The molar fraction of state B is not required as it follows fracB = 1 - fracA</span>

<span class="c1"># Generate the two distributions for conditions 1 &amp; 2</span>
<span class="n">P1</span> <span class="o">=</span> <span class="nf">dd_gauss2</span><span class="p">(</span><span class="n">r</span><span class="p">,[</span><span class="n">rmeanA</span><span class="p">,</span> <span class="n">fwhmA</span><span class="p">,</span> <span class="n">fracA1</span><span class="p">,</span> <span class="n">rmeanB</span><span class="p">,</span> <span class="n">fwhmB</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">fracA1</span><span class="p">])</span>
<span class="n">P2</span> <span class="o">=</span> <span class="nf">dd_gauss2</span><span class="p">(</span><span class="n">r</span><span class="p">,[</span><span class="n">rmeanA</span><span class="p">,</span> <span class="n">fwhmA</span><span class="p">,</span> <span class="n">fracA2</span><span class="p">,</span> <span class="n">rmeanB</span><span class="p">,</span> <span class="n">fwhmB</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">fracA2</span><span class="p">])</span>

<span class="c1"># Generate the corresponding dipolar kernels</span>
<span class="n">K1</span> <span class="o">=</span> <span class="nf">dipolarkernel</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">K2</span> <span class="o">=</span> <span class="nf">dipolarkernel</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>

<span class="c1"># ...and the two corresponding signals</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">V1</span> <span class="o">=</span> <span class="n">K1</span><span class="nd">@P1</span> <span class="o">+</span> <span class="nf">whitegaussnoise</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">V2</span> <span class="o">=</span> <span class="n">K2</span><span class="nd">@P2</span> <span class="o">+</span> <span class="nf">whitegaussnoise</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span><span class="mf">0.02</span><span class="p">)</span>
<span class="c1"># (for the sake of simplicity no background and 100# modulation depth are assumed)</span>
</pre></div>
</div>
</div>
<div class="section" id="global-fit">
<h2>Global fit<a class="headerlink" href="#global-fit" title="Permalink to this headline">¶</a></h2>
<p>Now when considering such systems is always important to (1) identify the
parameters which must be fitted and (2) identify which parameters are the
same for all signals (global) and which are specific for a individual
signal (local).</p>
<dl class="simple">
<dt>In this examples we have the following parameters:</dt><dd><ul class="simple">
<li><p>fixed: <code class="docutils literal notranslate"><span class="pre">fwhmA</span></code>, <code class="docutils literal notranslate"><span class="pre">fwhmB</span></code> (known paramters)</p></li>
<li><p>global: <code class="docutils literal notranslate"><span class="pre">rmeanA</span></code>, <code class="docutils literal notranslate"><span class="pre">rmeanB</span></code> (same for both signals)</p></li>
<li><p>local: <code class="docutils literal notranslate"><span class="pre">fracA1</span></code>, <code class="docutils literal notranslate"><span class="pre">fracA2</span></code> (different for both signals/conditions)</p></li>
</ul>
</dd>
</dl>
<p>The next step is to construct the model function which describes our
system. This function models the signals in our A-B system, and it is used to
simulate all signals passed to <code class="docutils literal notranslate"><span class="pre">fitparamodel</span></code>. The function must
return (at least) a list of simulations of all the signals
passed to <code class="docutils literal notranslate"><span class="pre">fitparamodel</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Model definition</span>
<span class="k">def</span> <span class="nf">myABmodel</span><span class="p">(</span><span class="n">par</span><span class="p">):</span>

    <span class="c1">#Fixed parameters</span>
    <span class="n">fwhmA</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">fwhmB</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="c1">#Global parameters</span>
    <span class="n">rmeanA</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rmeanB</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1">#Local parameters</span>
    <span class="n">fracA1</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">fracA2</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="c1"># Generate the signal-specific distribution</span>
    <span class="n">Pfit1</span> <span class="o">=</span> <span class="nf">dd_gauss2</span><span class="p">(</span><span class="n">r</span><span class="p">,[</span><span class="n">rmeanA</span><span class="p">,</span> <span class="n">fwhmA</span><span class="p">,</span> <span class="n">fracA1</span><span class="p">,</span> <span class="n">rmeanB</span><span class="p">,</span> <span class="n">fwhmB</span><span class="p">,</span> <span class="nf">max</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">fracA1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
    <span class="n">Pfit2</span> <span class="o">=</span> <span class="nf">dd_gauss2</span><span class="p">(</span><span class="n">r</span><span class="p">,[</span><span class="n">rmeanA</span><span class="p">,</span> <span class="n">fwhmA</span><span class="p">,</span> <span class="n">fracA2</span><span class="p">,</span> <span class="n">rmeanB</span><span class="p">,</span> <span class="n">fwhmB</span><span class="p">,</span> <span class="nf">max</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">fracA2</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>

    <span class="c1"># Generate signal #1</span>
    <span class="n">V1fit</span> <span class="o">=</span> <span class="n">K1</span><span class="nd">@Pfit1</span>
    <span class="c1"># Generate signal #2</span>
    <span class="n">V2fit</span> <span class="o">=</span> <span class="n">K2</span><span class="nd">@Pfit2</span>
    <span class="c1"># Return as a list</span>
    <span class="n">Vfits</span> <span class="o">=</span> <span class="p">[</span><span class="n">V1fit</span><span class="p">,</span><span class="n">V2fit</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">Vfits</span><span class="p">,</span><span class="n">Pfit1</span><span class="p">,</span><span class="n">Pfit2</span>

<span class="c1">#-----------------------------------------</span>
<span class="c1">#                Fit parameters</span>
<span class="c1">#-----------------------------------------</span>
<span class="c1">#        [rmeanA rmeanB fracA1 fracA2]</span>
<span class="c1">#-----------------------------------------</span>
<span class="n">par0</span> <span class="o">=</span>   <span class="p">[</span><span class="mi">2</span><span class="p">,</span>       <span class="mi">2</span><span class="p">,</span>    <span class="mf">0.5</span><span class="p">,</span>    <span class="mf">0.5</span><span class="p">]</span>
<span class="n">lower</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span>       <span class="mi">1</span><span class="p">,</span>     <span class="mi">0</span><span class="p">,</span>      <span class="mi">0</span><span class="p">]</span>
<span class="n">upper</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">20</span><span class="p">,</span>     <span class="mi">20</span><span class="p">,</span>     <span class="mi">1</span><span class="p">,</span>      <span class="mi">1</span><span class="p">]</span>
<span class="c1">#-----------------------------------------</span>
</pre></div>
</div>
<p>Note that our model function <code class="docutils literal notranslate"><span class="pre">myABmodel</span></code> returns multiple outputs.
This is advantegoud to later recover all fits directly, however, the fit
function does only allow one output, specifically, the list of simulated signals.
Therefore, we must create a lambda function which just takes the first ouput argument
of <code class="docutils literal notranslate"><span class="pre">myABmodel</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">par</span><span class="p">:</span> <span class="n">myABmodel</span><span class="p">(</span><span class="n">par</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># call myABmodel with par and take the first output</span>

<span class="c1"># Collect data for global fit into cell arrays</span>
<span class="n">Vs</span> <span class="o">=</span> <span class="p">[</span><span class="n">V1</span><span class="p">,</span><span class="n">V2</span><span class="p">]</span>

<span class="c1"># Fit the global parametric model to both signals</span>
<span class="n">fit</span> <span class="o">=</span> <span class="nf">fitparamodel</span><span class="p">(</span><span class="n">Vs</span><span class="p">,</span><span class="n">model</span><span class="p">,</span><span class="n">par0</span><span class="p">,</span><span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">multistart</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

<span class="c1"># The use of the option &#39;multistart&#39; will help the solver to find the</span>
<span class="c1"># global minimum and not to get stuck at local minima.</span>

<span class="c1"># Get the fitted models</span>
<span class="n">Vfits</span><span class="p">,</span><span class="n">Pfit1</span><span class="p">,</span><span class="n">Pfit2</span> <span class="o">=</span> <span class="n">myABmodel</span><span class="p">(</span><span class="n">fit</span><span class="o">.</span><span class="n">param</span><span class="p">)</span>
<span class="n">Vfit1</span> <span class="o">=</span> <span class="n">Vfits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Vfit2</span> <span class="o">=</span> <span class="n">Vfits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-results">
<h2>Plot results<a class="headerlink" href="#plot-results" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">V1</span><span class="p">,</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span><span class="n">t1</span><span class="p">,</span><span class="n">Vfit1</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s1">&#39;t [$\mu s$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s1">&#39;V(t)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">title</span><span class="p">(</span><span class="s1">&#39;Conditions #1&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">P1</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">Pfit1</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s1">&#39;r [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s1">&#39;P(r) [nm]^{-1}&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">legend</span><span class="p">([</span><span class="s1">&#39;truth&#39;</span><span class="p">,</span><span class="s1">&#39;fit&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span><span class="n">V2</span><span class="p">,</span><span class="s1">&#39;k.&#39;</span><span class="p">,</span><span class="n">t2</span><span class="p">,</span><span class="n">Vfit2</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s1">&#39;t [$\mu s$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s1">&#39;V(t)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">title</span><span class="p">(</span><span class="s1">&#39;Conditions #2&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">P2</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">Pfit2</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s1">&#39;r [nm]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s1">&#39;P(r) [nm]$^{-1}$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="nf">legend</span><span class="p">([</span><span class="s1">&#39;truth&#39;</span><span class="p">,</span><span class="s1">&#39;fit&#39;</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="nf">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="Conditions #1, Conditions #2" class="sphx-glr-single-img" src="../_images/sphx_glr_plot_globalfits_local_and_global_parameters_001.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  2.453 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-plot-globalfits-local-and-global-parameters-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/2899f2ebe9727c679a63906f55c80383/plot_globalfits_local_and_global_parameters.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_globalfits_local_and_global_parameters.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/d15ee86f581f7b2e46de4e6f21f0be79/plot_globalfits_local_and_global_parameters.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_globalfits_local_and_global_parameters.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plot_bootstrapped_parameter_distributions.html" class="btn btn-neutral float-right" title="Bootstrapped distributions of fit parameters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plot_multigauss_fitting_4pdeer.html" class="btn btn-neutral float-left" title="Multi-Gauss fit of a 4-pulse DEER signal" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2019-2020, Luis Fábregas Ibáñez, Stefan Stoll, and others

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>